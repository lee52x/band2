<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="notice">

<select id="listNotice" parameterType="map" resultType="com.band.manager.notice.Notice">
SELECT * FROM(
	SELECT tb.*, ROWNUM rnum FROM(
		SELECT noticeNo, content, created, endDate, groupURL 
		FROM notice
		WHERE groupURL=#{groupURL}
		ORDER BY noticeNo DESC
	<![CDATA[
	    ) tb WHERE ROWNUM <= #{end}
	) WHERE rnum >= #{start}
	]]>

</select>

<insert id="insertNotice" parameterType="com.band.manager.notice.Notice">
	  INSERT INTO notice(noticeNo, content, endDate, groupURL)
	  VALUES (notice_seq.NEXTVAL, #{content}, TO_DATE((SUBSTR(#{noticeDate}, -10 ,10)), 'MM/DD/YYYY'), #{groupURL})
</insert>

<select id="dataCount" parameterType="map" resultType="Integer">
	  SELECT NVL(COUNT(*), 0) FROM notice WHERE groupURL=#{groupURL}
</select>

 <!-- 수정 -->
<update id="updateNotice" parameterType="com.band.manager.notice.Notice">
	UPDATE notice SET content=#{content}, endDate=#{endDate} WHERE noticeNo = #{noticeNo}
</update>
      
<!-- 삭제 -->
<delete id="deleteNotice" parameterType="Integer">
	DELETE FROM notice WHERE noticeNo = #{noticeNo}
</delete>

</mapper>